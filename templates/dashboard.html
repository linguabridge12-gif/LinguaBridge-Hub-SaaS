{% extends "base.html" %}

{% block content %}
<section class="dashboard-hero">
  <h1>Hello, {{ current_user.email.split('@')[0] }}!</h1>
  <p>Hereâ€™s your learning dashboard. Track progress, view lessons, and access analytics.</p>
</section>

<section class="user-stats">
  <div class="stats-grid">
    <div class="stat-card">
      <h3>ðŸ“š Lessons Enrolled</h3>
      <p>{{ enroll_count }}</p>
    </div>
    <div class="stat-card">
      <h3>âœ… Lessons Completed</h3>
      <p>{{ completed }}</p>
    </div>
    <div class="stat-card">
      <h3>ðŸŽ¯ Total Interactions</h3>
      <p>{{ events }}</p>
    </div>
  </div>
</section>

<section class="my-lessons">
  <h2>Your Lessons</h2>
  <div class="lessons-grid">
    {% for lesson in lessons %}
      <div class="lesson-card">
        <h3>{{ lesson.title }}</h3>
        <p>{{ lesson.content }}</p>
        {% if lesson.quiz %}
        <button onclick="toggleQuiz('quiz-{{ lesson.id }}', {{ lesson.id }})" class="quiz-btn">Show Quiz</button>
        <div id="quiz-{{ lesson.id }}" style="display:none;">
          {% for q in lesson.quiz %}
            <p><strong>Q:</strong> {{ q.question }}</p>
            <p><strong>A:</strong> {{ q.answer }}</p>
          {% endfor %}
        </div>
        {% endif %}
        <form method="post" action="{{ url_for('enroll', lesson_id=lesson.id) }}">
          <button type="submit" class="btn btn-outline">Enroll</button>
        </form>
      </div>
    {% endfor %}
  </div>
</section>
{% endblock %}

